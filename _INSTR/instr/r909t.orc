

gkr909t_snare[]				fillarray 	0, 0, 0, 0
gkr909t_snare_rimshot[]		fillarray 	0, 0, 0, 1
gkr909t_snare_handclap[]	fillarray 	0, 0, 0, 0

gkr909t_tom_low[]			fillarray 	0, 0, 1, 0, 	0, 0, 0, 1
gkr909t_tom_mid[]			fillarray 	0, 0, 0, 2, 	0, 0, 0, 0	
gkr909t_tom_high[]			fillarray 	0, 0, 0, 0, 	0, 0, 0, 1

gkr909t_bass_1[]			fillarray 	2, 0, 0, 0, 	1, 0, 0, 0, 	2, 0, 0, 0, 	1, 0, 0, 0
gkr909t_bass_2[]			fillarray 	0, 0, 0, 1, 	0, 1, 0, 0, 	0, 0, 0, 2, 	0, 0, 1, 0



gSr909t_bass_1[] 			fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0A0A7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0A0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0A0D3.WAV"
gSr909t_bass_2[] 			fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0A0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0AAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT0AADA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3A0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3A0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3A0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3A0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3AAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT3AADA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7A0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7A0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7A0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7A0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7AAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BT7AADA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAA0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAA0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAA0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAA0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAAAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/BTAAADA.WAV"
gSr909t_snare[] 				fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T0S0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T0S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T0S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T0SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T3S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T3S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T3SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T7S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T7S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0T7SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0TAS3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0TAS7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST0TASA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T0S0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T0S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T0S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T0SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T3S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T3S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T3SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T7S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T7S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3T7SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3TAS3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3TAS7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST3TASA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T0S0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T0S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T0S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T0SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T3S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T3S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T3SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T7S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T7S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7T7SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7TAS3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7TAS7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/ST7TASA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT0S0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT0S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT0S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT0SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT3S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT3S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT3SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT7S3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT7S7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STAT7SA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STATAS3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STATAS7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/STATASA.WAV"


gSr909t_snare_rimshot[] 		fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/RIM63.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/RIM127.WAV"

gSr909t_snare_handclap[] 	fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HANDCLP1.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HANDCLP2.WAV"


gSr909t_tom_low[] 			fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT3D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT3D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT3D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT3DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT7D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT7D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT7D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LT7DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LTAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LTAD3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LTAD7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/LTADA.WAV"


gSr909t_tom_mid[] 			fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT3D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT3D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT3D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT3DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT7D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT7D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT7D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MT7DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MTAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MTAD3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MTAD7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/MTADA.WAV"


gSr909t_tom_high[] 			fillarray \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT0D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT0D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT0D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT0DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT3D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT3D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT3D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT3DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT7D0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT7D3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT7D7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HT7DA.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HTAD0.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HTAD3.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HTAD7.WAV", \
	"/Users/j/Documents/PROJECTs/CORDELIA/_INSTR/sonvs/Roland TR-909/HTADA.WAV"


; ==================================================================================
; ==================================================================================
; ==================================================================================
; ==================================================================================
; ==================================================================================

#define if_r909t(array'dyn) #
kdyn_$array = gkr909t_$array[k16th%lenarray(gkr909t_$array)]
if kdyn_$array >= 1 then
	if gkr909t_stopper < 3.95 then
		schedulek "r909t_instrument", 0, 1, idyn*kdyn_$array/$dyn, ich, gSr909t_$array[random:k(0, lenarray(gSr909t_$array))], gkr909t_ratio
	endif

	if random:k(0, 1) > .895 then
		kvar = floor(random:k(6, 13))
		schedulek "r909t_instrument", gkbeats/kvar, 1, idyn*kdyn_$array/$dyn/kvar, ich, gSr909t_$array[random:k(0, lenarray(gSr909t_$array))], gkr909t_ratio*gkr909t_ratio
	endif

endif
#

gkr909t_stopper init 0
gkr909t_ratio	init 1

$start_instr(r909t)
	idiv			init icps%i(gkdiv)
	kdiv_bar		init -1
	ksubdiv 		init -1

	if active:i("r909t_controller") == 0 then
		schedule "r909t_controller", 0, idur
	endif

	; divide the main 64 quarter notes into a subdivision of 8 quarter notes
	; so from 0 to 1 now the cycle is from 0 to (64 / 8) = 8
	; representing the 8 bars
	kcycle			chnget "heart"
	kdiv_bar		= kcycle * divz(gkdiv, idiv, 1)


	; in order to get each quarter notes subdivision of 32
	; get the modulo 1 of the cycle and then multiply by 8
	ksubdiv	= (kdiv_bar % 1) * idiv

	; 4 for 16th, 8 for 32th..
	;k16th	= floor( (ksubdiv % 1) * 4 ) + 4 * floor( (gkHEART * gkdiv) )
	k16th	= floor( (ksubdiv % 1) * idiv ) + idiv * floor( (kcycle * gkdiv) )

	if changed2(k16th) == 1 then
		$if_r909t(snare'3)
		$if_r909t(snare_rimshot'2)
		$if_r909t(snare_handclap'4)
		$if_r909t(tom_low'8)
		$if_r909t(tom_mid'8)
		$if_r909t(tom_high'8)
		$if_r909t(bass_2'2)
		$if_r909t(bass_1'2)
	endif

endin

instr r909t_controller
	gkr909t_stopper  random 0, 4

	gkr909t_ratio 	= random:k(0, 4) < 3.95 ? 1 : -1
endin

;#define r909t_chebyshev #int(random:i(0, -2))*random#

instr r909t_instrument
	Sinstr 	init "r909t"
	idyn 	init p4
	ich		init p5
	Spath 	init p6
	iratio 	init p7

	ilen 	filelen Spath
	p3 		init ilen
	idur 	init p3

	aout	diskin Spath, iratio+random:i(-.05, .05)
	aout	chebyshevpoly aout, 0, .95, .5, 1/3, .5, .75;, k6
	aout	*= cosseg(0, .005, 1, p3-.01, 1, .005, 0)*idyn
	aout	mvchpf aout/2.5, 20, .5
	aout	zdf_2pole aout, ntof("4B"), 1, 6

	;aout	flanger aout/2, cosseg:a(0, idur, idur/random:i(950, 1050)), cosseg:k(random:i(1, 0), idur, 0)
	;aout 	limit aout/2, -.95, 95
	$channel_mix
endin

